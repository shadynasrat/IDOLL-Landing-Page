<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IDOLL — Early Access</title>
    <meta name="description" content="Request early access to IDOLL and enter your invite code to start using the web app." />
    <link rel="icon" href="/static/favicon.ico" />
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Supabase config: paste your project URL and anon key below -->
    <script>
      // Replace these with your actual Supabase project URL and anon public key
      window.SUPABASE_URL = window.SUPABASE_URL || 'https://xttiepbeyfggzapzqyba.supabase.co';
      window.SUPABASE_ANON_KEY = window.SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh0dGllcGJleWZnZ3phcHpxeWJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1MTY4NzUsImV4cCI6MjA3MjA5Mjg3NX0.VC01eM66OFlJlRiZNasyaJWRb3rjqnzHgW2y9lN_U4Q';
    </script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: { ink: '#121826', night: '#0b0f17' },
            boxShadow: { glow: '0 0 0 2px rgba(255,255,255,0.15), 0 10px 40px rgba(0,0,0,0.35)' }
          }
        }
      }
    </script>
    <style>
      .bg-aurora { background: radial-gradient(1200px 800px at 10% 10%, rgba(255, 94, 247, 0.25), transparent 40%),
                                   radial-gradient(900px 600px at 90% 20%, rgba(0, 164, 255, 0.20), transparent 40%),
                                   radial-gradient(1000px 700px at 50% 100%, rgba(255, 196, 0, 0.18), transparent 40%),
                                   linear-gradient(180deg, #0b0f17 0%, #121826 100%); }
      .glass { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.15); }
      .hairline { height: 1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent); }
    </style>
  </head>
  <body class="bg-aurora text-white min-h-screen">
    <header class="max-w-4xl mx-auto px-5 pt-5">
      <div class="glass rounded-2xl px-4 py-3 flex items-center justify-between">
        <a href="/" class="inline-flex items-center gap-3">
          <img src="./src/logo-white.png" alt="IDOLL" class="h-8 w-auto" />
          <span class="sr-only">IDOLL</span>
        </a>
        <nav class="text-sm text-white/70 hidden sm:flex gap-6">
          <a href="/index.html#join" class="hover:text-white">Waitlist</a>
          <a href="#invite" class="hover:text-white">Enter Invite</a>
        </nav>
      </div>
    </header>

    <main class="max-w-4xl mx-auto px-5 pt-10 pb-20">
      <section class="grid md:grid-cols-2 gap-10 items-start">
        <div>
          <span class="inline-flex items-center gap-2 text-xs rounded-full bg-white/10 border border-white/20 px-3 py-1">
            <span class="size-2 rounded-full bg-emerald-400 animate-pulse"></span>
            Early Access • Private Beta
          </span>
          <h1 class="mt-4 text-4xl sm:text-5xl font-black leading-tight">Be first to meet IDOLL</h1>
          <p class="mt-4 text-white/80">Sign in with email or Google to check your Early Access status. If you have an invite code, you can enter it below to unlock immediately.</p>

          <div class="mt-6 flex flex-wrap gap-3">
            <a href="/index.html#join" class="inline-flex items-center rounded-full bg-white text-ink px-5 py-3 font-medium hover:opacity-95">Request access</a>
            <a href="#invite" class="inline-flex items-center rounded-full border border-white/30 px-5 py-3 font-medium hover:bg-white/10">I have an invite</a>
          </div>

          <div class="mt-8 text-xs text-white/60">Problems with your code? Email support@idoll.love with your invite ID.</div>

          <!-- Auth Box -->
          <div class="mt-8 glass rounded-2xl p-5">
            <h2 class="text-xl font-semibold">Sign in</h2>
            <p class="text-sm text-white/70 mt-1">Use Google or get a magic link by email.</p>
            <div id="auth-status" class="hidden text-emerald-300 text-sm mt-2"></div>

            <div class="mt-4 flex flex-col gap-3">
              <button id="google-signin" class="inline-flex items-center justify-center gap-2 rounded-full bg-white text-ink px-4 py-2.5 font-medium hover:opacity-95">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" class="h-5 w-5" />
                Continue with Google
              </button>

              <form id="email-form" class="flex gap-2">
                <input id="magic-email" type="email" required placeholder="you@example.com" class="flex-1 rounded-xl bg-white/10 border border-white/20 px-3 py-2 outline-none focus:ring-2 focus:ring-white/40" />
                <button type="submit" class="rounded-xl bg-white text-ink px-4 py-2 font-medium hover:opacity-95">Email me a link</button>
              </form>
              <div id="email-msg" class="text-xs text-white/70"></div>
              <div id="pending-msg" class="hidden text-sm text-white/80">Signed in but not approved yet. If you have an invite code, enter it below. Otherwise you’ll be notified when your access is ready.</div>
            </div>
          </div>
        </div>

        <div id="invite" class="glass rounded-2xl p-5">
          <h2 class="text-xl font-semibold">Enter invite code</h2>
          <p class="text-sm text-white/70 mt-1">Use the code from your email to unlock the web app.</p>
          <div id="already-approved" class="hidden mt-3 text-emerald-300 text-sm">
            Access already granted on this device. <a href="./templates/webapp.html" class="underline">Continue to IDOLL</a>.
          </div>
          <form id="invite-form" class="mt-4 space-y-3">
            <div>
              <label for="email" class="block text-sm mb-1">Email</label>
              <input id="email" name="email" type="email" required placeholder="you@example.com" class="w-full rounded-xl bg-white/10 border border-white/20 px-3 py-2 outline-none focus:ring-2 focus:ring-white/40" />
            </div>
            <div>
              <label for="code" class="block text-sm mb-1">Invite code</label>
              <input id="code" name="code" type="text" required placeholder="e.g. IDOLL-ALPHA-2024" class="w-full uppercase tracking-wider rounded-xl bg-white/10 border border-white/20 px-3 py-2 outline-none focus:ring-2 focus:ring-white/40" />
              <p class="text-xs text-white/50 mt-1">Case-insensitive; dashes optional.</p>
            </div>
            <button type="submit" class="w-full rounded-full bg-white text-ink px-5 py-2.5 font-medium hover:opacity-95">Continue</button>
            <p id="error" class="hidden text-rose-300 text-sm"></p>
          </form>
        </div>
      </section>

      <div class="mt-16 hairline"></div>
      <section class="mt-10">
        <h3 class="text-lg font-semibold">No invite yet?</h3>
        <p class="text-white/70 mt-1">Join the waitlist and we’ll reach out as capacity opens.</p>
        <a href="/index.html#join" class="mt-4 inline-flex items-center rounded-full bg-white text-ink px-5 py-2.5 font-medium hover:opacity-95">Join the waitlist</a>
      </section>
    </main>

    <script type="module" src="./static/js/early_access.js"></script>
    <script>
      // Auto show error if redirected from denied
      const params = new URLSearchParams(location.search);
      const denied = params.get('denied');
      const error = document.getElementById('error');

      if (denied) {
        error.textContent = 'Early access required. Please enter your invite code or request access.';
        error.classList.remove('hidden');
      }
    </script>
  </body>
</html>
